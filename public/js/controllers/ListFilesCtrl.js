myapp.controller('ListFilesCtrl', ["$scope", "$http", "$route", "$location", "$routeParams", 
function ($scope, $http, $route, $location, $routeParams) {

    $scope.search= false;
    //Directs to the chat page
    $scope.goChat = function(){
        $location.path('/chat');
    } 

    $scope.refresh = function(){
        $route.reload();  
    }

    // getting all files
    $http.get('/api/files')
        .success(function(data) {
            $scope.file = data;
                for(i=0; i<data.length; i++){
                    fileNameStr = data[i].fileName;
                    fileType = fileNameStr.slice(-3);
                    if(fileType === "png" || fileType === "jpg")
                    {
                        data[i].svgPath = "imagefiles";
                    }
                    else if(fileType === "wav" || fileType === "mp3"|| fileType === "mp3" || fileType === "wma" || fileType === "ogg")
                    {
                        data[i].svgPath = "audiofiles";
                    }
                    else if(fileType === "mp4" || fileType === "mov")
                    {
                        data[i].svgPath = "videofiles";
                    }
                    else
                    {
                        data[i].svgPath = "allfiles";
                    }
                };
                
        })
        .error(function(data) {
            console.log('Error: ' + data);
    });

}]);
// Using directives to get tab fileicon 
myapp.directive('fileIcon', function(){
    function link(scope, element, attrs) {

        function path(icon) {
            return '<svg class="file-icon"><defs><style>.cls-1{fill:#ede3d6;}.cls-2{fill:#604b2e;}</style></defs>' + fileicon[icon] + '</svg>';
        }

        function renderSVG() {
            element.html( path(attrs.p) );
        }

        renderSVG();
    }

    return {
        link: link,
        restrict: 'E'
    }
})

var fileicon = {   
    allfiles : '<path class="cls-1" d="M23.64,4c-0.86-.75-1.73-1.5-2.6-2.24L10.47,1.34l1.16,20.37L26.5,22.83l0.19-16A39.21,39.21,0,0,1,23.64,4Z"/><path class="cls-2" d="M28.23,8.21a9.21,9.21,0,0,1-.88-1C25.9,6.46,24.78,5,23.64,4S21.39,2.07,20.26,1.1C20,0.87,19.7.65,19.42,0.43L10.51,0a1.32,1.32,0,0,0-.37,0A1,1,0,0,0,8.81,1L10,17.16c0.11,1.51-.39,4.75,1.5,5.52a11.09,11.09,0,0,0,3,.44q2.32,0.24,4.65.35,2.16,0.1,4.33.1a9.77,9.77,0,0,0,3.33-.21c1.92-.73,1.34-3.92,1.39-5.42C28.27,14.7,28.29,11.45,28.23,8.21Zm-2.35,6.45c0,2.08-.26,4.18-0.23,6.25,0,0.77.3,0.53-.56,0.5-0.55,0-1.11,0-1.66,0q-1.83,0-3.66-.07-1.66-.07-3.32-0.2c-1-.08-2.94,0-3.6-0.67s-0.44-2.41-.5-3.33l-0.22-3-0.87-12,8.33,0.4,6.3,5.73C25.92,10.42,25.92,12.54,25.88,14.66Z"/><path class="cls-1" d="M19.24,7.33c-0.86-.75-1.73-1.5-2.6-2.24L6.06,4.65,7.23,25,22.1,26.14l0.19-16A39.21,39.21,0,0,1,19.24,7.33Z"/><path class="cls-2" d="M23.83,11.52a9.21,9.21,0,0,1-.88-1c-1.44-.78-2.57-2.21-3.71-3.22S17,5.38,15.85,4.41C15.58,4.17,15.29,4,15,3.73l-8.9-.43a1.32,1.32,0,0,0-.37,0,1,1,0,0,0-1.34,1L5.58,20.46C5.69,22,5.18,25.21,7.08,26a11.09,11.09,0,0,0,3,.44q2.32,0.24,4.65.35,2.16,0.1,4.33.1a9.77,9.77,0,0,0,3.33-.21c1.92-.73,1.34-3.92,1.39-5.42C23.87,18,23.88,14.76,23.83,11.52ZM21.48,18c0,2.08-.26,4.18-0.23,6.25,0,0.77.3,0.53-.56,0.5-0.55,0-1.11,0-1.66,0q-1.83,0-3.66-.07Q13.7,24.6,12,24.47c-1-.08-2.94,0-3.6-0.67S8,21.38,7.94,20.46l-0.22-3-0.87-12,8.33,0.4,6.3,5.73C21.51,13.73,21.52,15.85,21.48,18Z"/><path class="cls-1" d="M14.83,10.63c-0.86-.75-1.73-1.5-2.6-2.24L1.66,8,2.82,28.32,17.7,29.45l0.19-16A39.21,39.21,0,0,1,14.83,10.63Z"/><path class="cls-2" d="M19.43,15.49a1,1,0,0,0-.16-1.05c-0.42-1.58-2-2.5-3.25-3.71-1.4-1.38-3.36-3.21-5.35-3.65l0,0H10.44L10.21,7A0.82,0.82,0,0,0,10,7L1.71,6.61a1.32,1.32,0,0,0-.37,0A1,1,0,0,0,0,7.66L1.17,23.77c0.11,1.51-.39,4.75,1.5,5.52a11.1,11.1,0,0,0,3,.44Q8,30,10.29,30.08q2.16,0.1,4.33.1A9.77,9.77,0,0,0,17.95,30c1.92-.73,1.34-3.92,1.39-5.42C19.46,21.53,19.47,18.51,19.43,15.49Zm-2.85-1c-0.41.05-.82,0.1-1.24,0.11-0.58,0-2.79.2-3.16-.25S12,12.39,12,11.79s0-1,0-1.56Zm0.49,6.81c0,2.08-.26,4.18-0.23,6.25,0,0.77.3,0.53-.56,0.5-0.55,0-1.11,0-1.66,0Q12.79,28,11,28q-1.66-.07-3.32-0.2c-1-.08-2.94,0-3.6-0.67s-0.44-2.41-.5-3.33l-0.22-3-0.87-12,7.69,0.37c0,1.34,0,2.69.07,4,0.05,0.85-.12,2.18.73,2.69a8.34,8.34,0,0,0,3.57.52,16.17,16.17,0,0,0,2.58-.17C17.1,17.91,17.11,19.59,17.07,21.28Z"/>',
    videofiles : '<polygon class="cls-1" points="1.21 2.02 30.62 1.27 30.46 20.27 1.12 20.52 1.21 2.02"/><path class="cls-2" d="M31.37,19.63V1.14a1.19,1.19,0,0,0,0-.58A0.85,0.85,0,0,0,30.47,0C20.76,0.55,11.09.83,1.36,0.83a1,1,0,0,0-.94.55,1,1,0,0,0-.43.9q0.19,9,.07,17.91a1,1,0,0,0,.41.87,1,1,0,0,0,.92.48l29.15-.22C31.53,21.31,31.37,20.3,31.37,19.63Zm-29-8.14c0.89,0,1.78-.19,2.67-0.23l0,1.35H2.4S2.4,11.93,2.4,11.49Zm0-2.34c0-.43,0-1.55,0-1.55H5.12s0,0.9,0,1.29C4.2,8.94,3.29,9.11,2.39,9.16Zm0.32,8.45a1.77,1.77,0,0,0-.32.27c0-.83,0-1.27,0-2.27H5l0,2H2.71Zm2.47-13s0,1,0,1H2.35s0-1,0-1H5.18ZM7.24,19.22l0.13-8.67a1.32,1.32,0,0,0,0-.39l0.1-6.74a1.17,1.17,0,0,0-.05-0.35Q15.51,3,23.6,2.63q0.25,4,.49,8a1.33,1.33,0,0,0,0,.32q0.24,4.08.47,8.16ZM29.37,18a19.91,19.91,0,0,1-2.6.17c0-.62,0-1.56-0.08-1.56h2.68V18Zm0-4.39H26.56c0-1-.1-1.2-0.14-1.9,1,0,2,.16,3,0.08v1.82Zm0-4.1c-1,.09-2-0.05-3.09-0.07,0-.55,0-1.84-0.08-1.84h3.17v1.9Zm0-3.9H26.07c0-1-.08-1-0.12-2h3.43v2Z"/><path class="cls-2" d="M19.52,9.92q-1.7-1-3.43-1.93c-0.86-.47-2-1.24-2.89-0.49-0.75.59-.56,1.8-0.56,2.64,0,1.41,0,2.83.08,4.24a1.15,1.15,0,0,0,1.72,1l4.61-3a1.21,1.21,0,0,0,.39-0.42l0.1-.06A1.15,1.15,0,0,0,19.52,9.92Z"/>',
    audiofiles : '<polygon class="cls-1" points="2.59 8.01 8.39 7.75 13.42 2.17 14.11 20.94 8.26 17.26 5.35 17.26 1.61 16.53 2.59 8.01"/><path class="cls-2" d="M14.84,1.26A1.26,1.26,0,0,0,12.71.38L7.51,6.14c-2.09,0-4.45-.36-6.44.25a1.25,1.25,0,0,0-.87.87c-0.43,2-.05,4.29.06,6.35,0.06,1.17-.21,3.27.79,4.21s2.4,0.5,3.46.48c4.11-.09,5.66,1.38,8.65,4a1.26,1.26,0,0,0,2.13-.88Q15.41,11.35,14.84,1.26ZM2.63,15.84s0.06-3.53.05-3.59c-0.07-1.42-.58-2.69.82-3.62,0.73-.48,3.42,0,4.23,0a1.2,1.2,0,0,0,.58-0.15,1.08,1.08,0,0,0,.77-0.38l3.4-3.78q0.33,7.18.32,14.36c-2-1.71-4-3-7-2.93C5.34,15.78,2.94,16.18,2.63,15.84Z"/><path class="cls-2" d="M18.79,7a1.25,1.25,0,0,0-2.15,1.26c0.69,1.2,1.22,3.63.34,4.85s1.23,2.55,2.15,1.26C20.53,12.43,19.91,8.95,18.79,7Z"/><path class="cls-2" d="M21.43,3.37a1.25,1.25,0,0,0-1.26,2.15c3.24,2,4.4,8.32,1,10.72-1.3.92-.06,3.08,1.26,2.15C27.38,14.91,26.42,6.38,21.43,3.37Z"/><path class="cls-2" d="M29.56,4.23C28.69,2.43,27.08,2.17,26,.73,25-.52,22.84.72,23.82,2a18.06,18.06,0,0,0,1.6,1.48C27.66,5.86,27.91,6.92,28,9.93c0.05,4.12-1.1,7.41-4.27,10.14-1.22,1.05.55,2.81,1.76,1.76a14.25,14.25,0,0,0,5-11.28C30.47,8.47,30.48,6.15,29.56,4.23Z"/>',
    imagefiles : '<polygon class="cls-1" points="1.98 1.55 29.05 1.87 29.92 21.86 2.73 22.18 1.6 20.9 1.98 1.55"/><polygon class="cls-1" points="5.97 18.69 10.59 12.36 13.7 14.55 18.57 9.01 20.32 9.47 26.18 18.69 5.97 18.69"/><path class="cls-2" d="M31.32,21.54s0,0,0-.07a131,131,0,0,0-.91-19.95A1.25,1.25,0,0,0,29.18.31a2,2,0,0,0-.58,0L1.82,0A1.23,1.23,0,0,0,.46,1.34v0q-0.6,10-.4,20a1.1,1.1,0,0,0,.12.47,1.27,1.27,0,0,0,1.3,1.67q14.32,0.37,28.65,0A1.26,1.26,0,0,0,31.32,21.54ZM2.9,21.05q-0.18-9.3.35-18.59L27.7,2.73A131,131,0,0,1,28.48,21Q15.69,21.34,2.9,21.05Z"/><path class="cls-2" d="M27.75,18.68L21.49,9.41c-0.59-.87-1.25-2.17-2.7-1.72-1.25.39-2.19,2.08-2.93,3l-1.51,1.82-0.56.69-0.09.07-0.1-.1c-0.85-.82-1.79-2.21-3.28-1.87s-2.23,2-3,2.95c-1.1,1.47-2.12,3-3.08,4.53-0.53.85,0.32,1.71,1.37,1.58l0.14,0a5.46,5.46,0,0,0,1.8,0,1.57,1.57,0,0,0,.31,0l18.45-.08C27.26,20.44,28.37,19.6,27.75,18.68ZM9.69,15a12.75,12.75,0,0,1,1.06-1.48c1.15,1.09,2.43,3.05,4.2,1.8a14.35,14.35,0,0,0,2.3-2.74l1.14-1.36c0.14-.17.48-0.69,0.81-1.1,0.43,0.6.8,1.3,1.17,1.85l1.74,2.58,2.37,3.51L8.33,18.2a1.59,1.59,0,0,0-.55-0.13H7.56q0.54-.81,1.11-1.61T9.69,15Z"/><path class="cls-2" d="M6.83,5.26a2,2,0,1,0,0,4A2,2,0,1,0,6.83,5.26Z"/>'
};
